{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 113, "column": 0}, "map": {"version":3,"sources":["file://C%3A/2%C2%BADAW/DWES/Proyectos/autenticacion-pizzeria/src/lib/prisma.js"],"sourcesContent":["import { PrismaClient } from \"@prisma/client\";\r\n\r\nconst prisma = global.prisma || new PrismaClient()\r\nif (process.env.NODE_ENV !== 'production') global.prisma = prisma\r\n\r\nexport default prisma"],"names":[],"mappings":";;;AAAA;;AAEA,MAAM,SAAS,OAAO,MAAM,IAAI,IAAI,6HAAA,CAAA,eAAY;AAChD,wCAA2C,OAAO,MAAM,GAAG;uCAE5C"}},
    {"offset": {"line": 121, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 127, "column": 0}, "map": {"version":3,"sources":["file://C%3A/2%C2%BADAW/DWES/Proyectos/autenticacion-pizzeria/src/lib/data.js"],"sourcesContent":["'use server'\r\nimport  prisma  from '@/lib/prisma'\r\n\r\nexport async function getUserById(id) {\r\n  const user = await prisma.user.findUnique({\r\n    where: { id }\r\n  });\r\n  return user\r\n}\r\n\r\nexport async function getUserByEmail(email) {\r\n  const user = await prisma.user.findUnique({\r\n    where: { email }\r\n  });\r\n  return user\r\n}\r\n\r\n\r\n\r\n\r\nasync function obtenerRepartidores() {\r\n  const repartidores = await prisma.repartidor.findMany()\r\n  return repartidores\r\n}\r\n\r\n\r\nasync function obtenerRepartidor(id) {\r\n  const repartidor = await prisma.repartidor.findUnique({\r\n      where: { id: +id }\r\n  })\r\n  return repartidor\r\n}\r\n\r\n\r\n// ---------------------   PEDIDOS -----------------------\r\n\r\nasync function obtenerPedidos() {\r\n  const pedidos = await prisma.pedido.findMany({\r\n      include: {\r\n          repartidor: true,\r\n          pizzas: true,\r\n      }\r\n  })\r\n  return pedidos\r\n}\r\n\r\n\r\nasync function obtenerPedido(id) {\r\n  const pedido = await prisma.pedido.findUnique({\r\n      where: { id: +id },\r\n      include: {\r\n          repartidor: true,\r\n          pizzas: true,\r\n      }\r\n  })\r\n  return pedido\r\n}\r\n\r\n// ---------------------   PIZZAS -----------------------\r\n\r\nasync function obtenerPizzas() {\r\n  const pizzas = await prisma.pizza.findMany()\r\n  return pizzas\r\n}\r\n\r\n\r\nasync function obtenerPizza(id) {\r\n  const pizza = await prisma.pizza.findUnique({\r\n      where: { id: +id }\r\n  })\r\n  return pizza\r\n}\r\n\r\n\r\nexport {\r\n  obtenerRepartidores,\r\n  obtenerRepartidor,\r\n  obtenerPedidos,\r\n  obtenerPedido,\r\n  obtenerPizzas,\r\n  obtenerPizza\r\n}"],"names":[],"mappings":";;;;;;;;;;;;AACA;;;;;AAEO,eAAe,uCAAS,GAAT,YAAY,EAAE;IAClC,MAAM,OAAO,MAAM,sHAAA,CAAA,UAAM,CAAC,IAAI,CAAC,UAAU,CAAC;QACxC,OAAO;YAAE;QAAG;IACd;IACA,OAAO;AACT;AAEO,eAAe,uCAAY,GAAZ,eAAe,KAAK;IACxC,MAAM,OAAO,MAAM,sHAAA,CAAA,UAAM,CAAC,IAAI,CAAC,UAAU,CAAC;QACxC,OAAO;YAAE;QAAM;IACjB;IACA,OAAO;AACT;AAKA,eAAe;IACb,MAAM,eAAe,MAAM,sHAAA,CAAA,UAAM,CAAC,UAAU,CAAC,QAAQ;IACrD,OAAO;AACT;AAGA,eAAe,kBAAkB,EAAE;IACjC,MAAM,aAAa,MAAM,sHAAA,CAAA,UAAM,CAAC,UAAU,CAAC,UAAU,CAAC;QAClD,OAAO;YAAE,IAAI,CAAC;QAAG;IACrB;IACA,OAAO;AACT;AAGA,0DAA0D;AAE1D,eAAe;IACb,MAAM,UAAU,MAAM,sHAAA,CAAA,UAAM,CAAC,MAAM,CAAC,QAAQ,CAAC;QACzC,SAAS;YACL,YAAY;YACZ,QAAQ;QACZ;IACJ;IACA,OAAO;AACT;AAGA,eAAe,cAAc,EAAE;IAC7B,MAAM,SAAS,MAAM,sHAAA,CAAA,UAAM,CAAC,MAAM,CAAC,UAAU,CAAC;QAC1C,OAAO;YAAE,IAAI,CAAC;QAAG;QACjB,SAAS;YACL,YAAY;YACZ,QAAQ;QACZ;IACJ;IACA,OAAO;AACT;AAEA,yDAAyD;AAEzD,eAAe;IACb,MAAM,SAAS,MAAM,sHAAA,CAAA,UAAM,CAAC,KAAK,CAAC,QAAQ;IAC1C,OAAO;AACT;AAGA,eAAe,aAAa,EAAE;IAC5B,MAAM,QAAQ,MAAM,sHAAA,CAAA,UAAM,CAAC,KAAK,CAAC,UAAU,CAAC;QACxC,OAAO;YAAE,IAAI,CAAC;QAAG;IACrB;IACA,OAAO;AACT;;;;IApEsB;IAOA;IAiEpB,uCAAiB,GAAjB;IACA,uCAAe,GAAf;IACA,uCAAY,GAAZ;IACA,uCAAW,GAAX;IACA,uCAAW,GAAX;IACA,uCAAU,GAAV;;AA7EoB,iPAAA;AAOA,iPAAA;AAiEpB,iPAAA;AACA,iPAAA;AACA,iPAAA;AACA,iPAAA;AACA,iPAAA;AACA,iPAAA"}},
    {"offset": {"line": 227, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 233, "column": 0}, "map": {"version":3,"sources":["file://C%3A/2%C2%BADAW/DWES/Proyectos/autenticacion-pizzeria/src/auth.config.js"],"sourcesContent":["import Google from \"@auth/core/providers/google\"\r\nimport GitHub from '@auth/core/providers/github'\r\nimport Discord from '@auth/core/providers/discord'\r\nimport Credentials from \"@auth/core/providers/credentials\"\r\nimport { getUserByEmail } from \"@/lib/data\"\r\n\r\nexport default {\r\n    providers: [\r\n        Google,\r\n        GitHub,\r\n        Discord,\r\n        Credentials({\r\n            async authorize(credentials) {\r\n                console.log('AUTHORIZE')\r\n                const user = await getUserByEmail(credentials.email)\r\n                return user\r\n            },\r\n        }),\r\n    ]\r\n}\r\n"],"names":[],"mappings":";;;AAAA;AACA;AACA;AACA;AACA;;;;;;uCAEe;IACX,WAAW;QACP,uJAAA,CAAA,UAAM;QACN,uJAAA,CAAA,UAAM;QACN,wJAAA,CAAA,UAAO;QACP,CAAA,GAAA,4JAAA,CAAA,UAAW,AAAD,EAAE;YACR,MAAM,WAAU,WAAW;gBACvB,QAAQ,GAAG,CAAC;gBACZ,MAAM,OAAO,MAAM,CAAA,GAAA,oHAAA,CAAA,iBAAc,AAAD,EAAE,YAAY,KAAK;gBACnD,OAAO;YACX;QACJ;KACH;AACL"}},
    {"offset": {"line": 260, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 266, "column": 0}, "map": {"version":3,"sources":["file://C%3A/2%C2%BADAW/DWES/Proyectos/autenticacion-pizzeria/src/auth.js"],"sourcesContent":["import NextAuth from \"next-auth\"\r\nimport  prisma  from \"@/lib/prisma\"\r\nimport { PrismaAdapter } from \"@auth/prisma-adapter\";\r\nimport { getUserById } from \"@/lib/data\"\r\nimport authConfig from \"@/auth.config\"\r\n\r\n\r\nexport const options = {\r\n    session: { strategy: 'jwt' },\r\n    adapter: PrismaAdapter(prisma),\r\n    pages: {\r\n        signIn: '/auth/login',\r\n        signOut: '/auth/logout',\r\n        error: '/auth/error'\r\n    },\r\n    events: {\r\n        async linkAccount({ user }) {\r\n            await prisma.user.update({\r\n                where: { id: user.id },\r\n                data: { emailVerified: new Date() }\r\n            })\r\n        }\r\n    },\r\n    callbacks: {\r\n        async session({ session, token }) {\r\n            session.user.id = token?.sub;     // Para recuperar ID de usuario desde el token\r\n            session.user.role = token?.role   // Para recuperar rol de usuario desde el token\r\n            return session\r\n        },\r\n\r\n        async jwt({ token }) {\r\n            if (!token.sub) return token;\r\n\r\n            const user = await getUserById(token.sub)\r\n            if (!user) return token;\r\n\r\n            token.role = user?.role\r\n            return token\r\n        }\r\n    },\r\n}\r\n\r\n\r\n\r\nexport const {\r\n    handlers: { GET, POST },\r\n    auth,\r\n    signIn,\r\n    signOut\r\n} = NextAuth({ ...options, ...authConfig })\r\n"],"names":[],"mappings":";;;;;;;;AAAA;AACA;AACA;AACA;AACA;AAJA;;;;;;AAOO,MAAM,UAAU;IACnB,SAAS;QAAE,UAAU;IAAM;IAC3B,SAAS,CAAA,GAAA,sJAAA,CAAA,gBAAa,AAAD,EAAE,sHAAA,CAAA,UAAM;IAC7B,OAAO;QACH,QAAQ;QACR,SAAS;QACT,OAAO;IACX;IACA,QAAQ;QACJ,MAAM,aAAY,EAAE,IAAI,EAAE;YACtB,MAAM,sHAAA,CAAA,UAAM,CAAC,IAAI,CAAC,MAAM,CAAC;gBACrB,OAAO;oBAAE,IAAI,KAAK,EAAE;gBAAC;gBACrB,MAAM;oBAAE,eAAe,IAAI;gBAAO;YACtC;QACJ;IACJ;IACA,WAAW;QACP,MAAM,SAAQ,EAAE,OAAO,EAAE,KAAK,EAAE;YAC5B,QAAQ,IAAI,CAAC,EAAE,GAAG,OAAO,KAAS,8CAA8C;YAChF,QAAQ,IAAI,CAAC,IAAI,GAAG,OAAO,KAAO,+CAA+C;;YACjF,OAAO;QACX;QAEA,MAAM,KAAI,EAAE,KAAK,EAAE;YACf,IAAI,CAAC,MAAM,GAAG,EAAE,OAAO;YAEvB,MAAM,OAAO,MAAM,CAAA,GAAA,oHAAA,CAAA,cAAW,AAAD,EAAE,MAAM,GAAG;YACxC,IAAI,CAAC,MAAM,OAAO;YAElB,MAAM,IAAI,GAAG,MAAM;YACnB,OAAO;QACX;IACJ;AACJ;AAIO,MAAM,EACT,UAAU,EAAE,GAAG,EAAE,IAAI,EAAE,EACvB,IAAI,EACJ,MAAM,EACN,OAAO,EACV,GAAG,CAAA,GAAA,uJAAA,CAAA,UAAQ,AAAD,EAAE;IAAE,GAAG,OAAO;IAAE,GAAG,uHAAA,CAAA,UAAU;AAAC"}},
    {"offset": {"line": 327, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 333, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":""}},
    {"offset": {"line": 335, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}}]
}